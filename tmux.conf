###############################################################################
# Cheatsheet
###############################################################################
# tpm #
# prefix + I        -> Install new Plugins and refresh TMUX environment
# prefix + U        -> Update Plugins
# prefix + alt + u  -> remove/uninstall plugins not on the plugin list
#
# copycat #
# prefix + /        -> regex search
# prefix + ctrl-f   -> simple file search
# prefix + ctrl-g   -> jumping over git status files (used after git status)
# prefix + alt-h    -> jumping over SHA-1 hashes (used after git log)
# prefix + ctrl-u   -> url search (http, ftp and git urls)
# prefix + ctrl-d   -> number search (mnemonic d, as digit)
# prefix + alt-i    -> ip address search
#
# tmux-yank #
# prefix + y        -> copies text from the command line to clipboard.
# prefix + Y        -> copy pane current working directory to clipboard.
# copy-mode
# y     -> copy selection to system clipboard
# Y     -> "put" selection - equivalent to copying a selection, and pasting
#          it to the command line
# 
# tmux-open #
# TODO
#
# tmux-resurrect #
# TODO
 
###############################################################################
# General Config
###############################################################################
# use UTF-8
set -g utf8
set-window-option -g utf8 on
set -g status-utf8 on
# set a high history limit
set -g history-limit 50000
# Allows for faster key repetition
set -s escape-time 0
# set window and pane index to 1 (0 by default)
 set-option -g base-index 1
 setw -g pane-base-index 1
###############################################################################
# Personal Key Bindings
###############################################################################
# remap Ctrl-b to more usefull Ctrl-space prefix.
unbind C-space
set -g prefix C-space
# Allows us to use C-space C-space <command> to send commands to a TMUX session
# inside another TMUX session
bind-key C-space send-prefix

# reload config
unbind r
bind-key r source-file ~/.tmux.conf \; display-message "Config reloaded"

# use vi like copy'n'paste mode
set-window-option -g mode-keys vi
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'V' rectangle-toggle
unbind [
bind Space copy-mode
bind C-Space copy-mode
unbind p
bind p paste-buffer

# redefine key bindings for pane selection to get rid of the bind-key's
# "-r" option that provides annoying key repetition
bind-key    Up      select-pane -U
bind-key    Down    select-pane -D
bind-key    Left    select-pane -L
bind-key    Right   select-pane -R

#move between windows like normal bash
bind-key -n C-h      previous-window
bind-key -n C-l      next-window

# use better to remember split keys
unbind %
unbind '"'
#open each window with the current path
bind - split-window -v -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

###############################################################################
# Color Scheme
###############################################################################
# to see a full list of all colour codes use the following commandline:
# for i in {0..255}; do     printf "\x1b[38;5;${i}mcolour${i}\x1b[0m\n"; done

# configure status bar info
set-option -g status-interval 5

## messages style
set-option -g message-style fg=colour33,bold
set-option -ga message-style bg=colour233

# set default colors
set-option -g status-bg colour233
set-option -g status-fg colour33

# Left Status Bar
set-option -g status-left-length 200
#show current hostname
set-option -g  status-left '@#H '
set-option -ga status-left '#[fg=colour233,bg=colour238]'
set-option -ga status-left '▶'
set-option -ga status-left '#[default]'
# show current cpu load (5min average)
set-option -ga status-left '#[bg=colour238]'
set-option -ga status-left 'cpu: #[bold]#(cut -d " " -f 2 /proc/loadavg) '
set-option -ga status-left '#[fg=colour238,bg=colour233]'
set-option -ga status-left '▶'
set-option -ga status-left '#[default]'

# Right Status Bar
set-option -g status-right-length 200
# show session name
set-option -g  status-right '#[fg=colour238,bg=colour233]'
set-option -ga status-right '◀'
set-option -ga status-right '#[default]'
set-option -ga status-right '#[bg=colour238]'
set-option -ga status-right ' #[bold]#S'
set-option -ga status-right '#[default]'
# show current date
set-option -ga status-right '#[fg=colour233,bg=colour238]'
set-option -ga status-right '◀'
set-option -ga status-right '#[default]'
set-option -ga status-right ' %d %b %Y'

# center align window list
set-option -g status-justify centre
# Active window
set-window-option -g  window-status-current-format '#[fg=colour238,bg=colour233]'
set-window-option -ga window-status-current-format '◀'
set-window-option -ga window-status-current-format '#[default]'
set-window-option -ga window-status-current-format '#[bg=colour238]'
set-window-option -ga window-status-current-format ' #[fg=red,bold]#I'
set-window-option -ga window-status-current-format '#[default]'
set-window-option -ga window-status-current-format '#[bg=colour238]'
set-window-option -ga window-status-current-format ':#W#F '
set-window-option -ga window-status-current-format '#[fg=colour238,bg=colour233]'
set-window-option -ga window-status-current-format '▶'

# other windows
set-window-option -g  window-status-format '#[default]'
set-window-option -ga window-status-format '#[fg=colour160,bold]#I'
set-window-option -ga window-status-format '#[default]'
set-window-option -ga window-status-format ':#W#F'

## pane border
set-option -g pane-border-fg colour17
set-option -g pane-active-border-fg colour33
###############################################################################
# Plugins
###############################################################################

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-open'
set -g @plugin 'tmux-plugins/tmux-resurrect'

######
# tmux-resurrect
######
# disable tool restore
set -g @resurrect-processes 'false'

######
# tmux-yank
######
set -g @yank_selection 'primary'

######
# tpm
######
# install tpm if not already installed
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'"

run '~/.tmux/plugins/tpm/tpm'
